{"primaryContentSections":[{"kind":"content","content":[{"anchor":"overview","level":2,"type":"heading","text":"Overview"},{"type":"codeListing","syntax":"swift","code":["\/\/\/ 受信したいデータを送信している送信元ノードのUUID","\/\/\/ （アップストリームを行っている送信元でConnection.Configで設定したnodeIDを指定してください。）","var targetDownstreamNodeID: String = \"00000000-0000-0000-0000-000000000000\"","\/\/\/ オープンしたダウンストリーム一覧","var downstreams: [Downstream] = []","","extension ExampleViewController {","    ","    func startDownstream() {","        \/\/ ダウンストリームをオープンします。","        connection?.openDownstream(","            downstreamFilters: [","                DownstreamFilter(","                    sourceNodeID: targetDownstreamNodeID, \/\/ 送信元ノードのIDを指定します。","                    dataFilters: [","                        DataFilter(","                            name: \"#\", type: \"#\" \/\/ 受信したいデータを名称と型で指定します。この例では、ワイルドカード `#` を使用して全てのデータを取得します。","                        )","                    ])","                ],","            completion: { downstream, error in","            guard let downstream = downstream else {","                \/\/ オープン失敗。","                return","            }","            \/\/ オープン成功。","            downstreams.append(downstream)","            \/\/ 受信データを取り扱うためにデリゲートを設定します。","            downstream.delegate = self \/\/ DownstreamDelegate","        })","    }","}","","extension ExampleViewController : DownstreamDelegate {","    ","    func didReceiveChunk(downstream: Downstream, message: DownstreamChunk) {","        \/\/ データポイントを読み込むことができた際にコールされます。","        print(\"Received dataPoints sequenceNumber[\\(message.sequenceNumber)], sessionId[\\(message.upstreamInfo.sessionID)]\")","        for g in message.dataPointGroups {","            for dp in g.dataPoints {","                print(\"Received a dataPoint dataName[\\(g.dataID.name)], dataType[\\(g.dataID.type)], payload[\\(String(data: dp.payload, encoding: .utf8) ?? \"\")]\")","            }","        }","    }","    ","    func didReceiveMetadata(downstream: Downstream, message: DownstreamMetadata) {","        \/\/ メタデータを受信した際にコールされます。","        print(\"Received a metadata sourceNodeID[\\(message.sourceNodeID)], metadataType:\\(String(describing: message.metadata))\")","        switch message.metadata {","        case .baseTime(let baseTime):","            print(\"Received baseTime[\\(Date(timeIntervalSince1970: baseTime.baseTime))], priority[\\(baseTime.priority)], name[\\(baseTime.priority)]\")","        default: break","        }","    }","    ","    func didFailWithError(downstream: Downstream, error: Error) {","        \/\/ 内部でエラーが発生した場合にコールされます。","    }","    ","    func didCloseWithError(downstream: Downstream, error: Error) {","        \/\/ 何らかの理由でストリームがクローズした場合にコールされます。","        \/\/ 再度ダウンストリームをオープンしたい場合は、 `Connection.reopenDownstream()` を使用することにより、ストリームの設定を引き継いで別のストリームを開くことが可能です。","    }","    ","    func didResume(downstream: Downstream) {","        \/\/ 自動再接続機能が働き、再接続が行われた場合にコールされます。","    }","    ","}"]}]}],"schemaVersion":{"major":0,"minor":1,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/iscp\/startdownstream"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/jp.co.aptpod.iSCP\/documentation\/iSCP\/StartDownstream","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"アップストリームで送信されたデータをダウンストリームで受信するサンプルです。このサンプルでは、アップストリーム開始のメタデータ、基準時刻のメタデータ、 文字列型のデータポイントを受信しています。"}],"kind":"article","metadata":{"roleHeading":"Article","title":"Start Downstream","role":"article","modules":[{"name":"iSCP"}]},"hierarchy":{"paths":[["doc:\/\/jp.co.aptpod.iSCP\/documentation\/iSCP"]]},"references":{"doc://jp.co.aptpod.iSCP/documentation/iSCP":{"role":"collection","title":"iSCP","abstract":[{"type":"text","text":"iSCP Client for Swift は、iSCP version 2 を用いたリアルタイムAPIにアクセスするためのクライアントライブラリです。"}],"identifier":"doc:\/\/jp.co.aptpod.iSCP\/documentation\/iSCP","kind":"symbol","type":"topic","url":"\/documentation\/iscp"}}}